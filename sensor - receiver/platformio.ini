; PlatformIO Configuration for LoRa Sensor Logger
; 
; RECEIVER (Master): Принимает события от датчиков, показывает лог на OLED
; SENSOR (Slave): Отправляет события при нажатии кнопки BOOT
;
; Прошивка:
;   RECEIVER: pio run -e T3_S3_LR1121_Receiver -t upload
;   SENSOR:   pio run -e T3_S3_LR1121_Sensor -t upload

[platformio]
default_envs = T3_S3_LR1121_Receiver

; ==================== RECEIVER (Master) ====================
[env:T3_S3_LR1121_Receiver]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
monitor_filters = esp32_exception_decoder, printable
upload_speed = 921600

board_build.mcu = esp32s3
board_build.f_cpu = 240000000L
board_build.flash_mode = qio
board_build.partitions = default.csv

build_flags = 
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCORE_DEBUG_LEVEL=0
    -DROLE_MASTER=1
    ; Параметры радио 2.4 GHz
    -DCONFIG_RADIO_FREQ=2450.0
    -DCONFIG_RADIO_OUTPUT_POWER=10
    -DCONFIG_RADIO_BW=406.25
    -DCONFIG_RADIO_SF=9
    -DCONFIG_RADIO_CR=5

lib_deps = 
    jgromes/RadioLib@^7.1.2
    olikraus/U8g2@^2.35.30

; ==================== SENSOR (Slave) ====================
[env:T3_S3_LR1121_Sensor]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
monitor_filters = esp32_exception_decoder, printable
upload_speed = 921600

board_build.mcu = esp32s3
board_build.f_cpu = 240000000L
board_build.flash_mode = qio
board_build.partitions = default.csv

build_flags = 
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCORE_DEBUG_LEVEL=0
    -DROLE_SLAVE=1
    ; Параметры радио 2.4 GHz (должны совпадать с RECEIVER!)
    -DCONFIG_RADIO_FREQ=2450.0
    -DCONFIG_RADIO_OUTPUT_POWER=10
    -DCONFIG_RADIO_BW=406.25
    -DCONFIG_RADIO_SF=9
    -DCONFIG_RADIO_CR=5
    ; Опционально: включить heartbeat
    ; -DENABLE_HEARTBEAT=1

lib_deps = 
    jgromes/RadioLib@^7.1.2
    olikraus/U8g2@^2.35.30

; ==================== SENSOR #2 (если нужен второй датчик) ====================
[env:T3_S3_LR1121_Sensor2]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
monitor_filters = esp32_exception_decoder, printable
upload_speed = 921600

board_build.mcu = esp32s3
board_build.f_cpu = 240000000L
board_build.flash_mode = qio
board_build.partitions = default.csv

build_flags = 
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCORE_DEBUG_LEVEL=0
    -DROLE_SLAVE=1
    -DSENSOR_ID=\"S02\"
    ; Параметры радио 2.4 GHz
    -DCONFIG_RADIO_FREQ=2450.0
    -DCONFIG_RADIO_OUTPUT_POWER=10
    -DCONFIG_RADIO_BW=406.25
    -DCONFIG_RADIO_SF=9
    -DCONFIG_RADIO_CR=5

lib_deps = 
    jgromes/RadioLib@^7.1.2
    olikraus/U8g2@^2.35.30
